#! /usr/bin/env python3

# https://www.alpertron.com.ar/ECM.HTM FORTISSIMO SITO FATTORIZZATORE
p1 = "11741 644141 862196 716288 294734 556791 281375 506026 500927 629354 856132 439964 706815 203188 997201 694574 048955 072193 942782 820729 148650 947367 698067 189279 934438 560699"
p2 = "11741 644141 862196 716288 294734 556791 281375 506026 500927 629354 856132 439964 706815 203188 997201 694574 048955 072193 942782 820729 148650 947367 698067 189279 934438 560897"
e= 65537
ct= 67932802035805588854278977673045833517593273239942847623689503474317866628886199433810017197037291176343627455376241464624870557830239851446861917867043000728823054049444875946790685574440463627283062014107345418490148867942084538625043907585104640830388180234446782401778750812259071969890168545489104373218

n= 137866207154126841926135173451358115364278213684521572523358907639756849267625989203803139156255011696944207127190680285326855425852764146184626857091525539105016966652616046475290899093074083795277502910801200926744561269527098028426269373323424980295041083818220821875656945269376954220805993190237542387003

p1 = int("".join(p1.split()))
p2 = int("".join(p2.split()))

phi = (p1- 1) * (p2-1)


d = pow(e,-1,phi)

plaintext = pow(ct,d,n)

print(plaintext)

plaintext = hex(plaintext)[2:]
print(plaintext)

from utilities import hexToStr

print(hexToStr(plaintext))

# sarebbe bello provare a fare una implementazione di Fermat da se'